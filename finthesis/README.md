# LaTeX класа finthesis

Ова класа предвиђена је за писање завршних, односно дипломских и мастер радова, првенствено на Факултету инжењерских наука Универзитета у Крагујевцу, али је може преузети и употребити ко год је сматра корисном. Документи који користе ову класу задовољавају форму која је задата у [упутству о пријави, изради и одбрани завршног и мастер рада](http://www.fink.rs/images/Fakultet/Dokumenta/Uputstvo_o_prijavi_izradi_i_odbrani_zavrsnog_i_master_rada.docx). Неке карактеристике ове класе су:

* Генеришу се четири насловне стране и страна која садржи апстракт. Садржајем насловних страна и апстракта управља се наредбама које дефинише класа `finthesis`.
* Постављају се одговарајуће маргине и величина фонта. За разлику од правилника, не користи се *Times New Roman* фонт, већ [*Computer Modern*](https://cm-unicode.sourceforge.io). Подешен је српски језик и ћирилично писмо, помоћу пакета [babel](https://ctan.org/pkg/babel).
* У излазној pdf датотеци уметнуте су везе ка разним елементима документа, попуњени су садржај и мета-подаци. Подразумевано је коришћење [hyperref](https://ctan.org/pkg/hyperref) пакета.
* Подразумевано је коришћење [biblatex](https://www.ctan.org/pkg/biblatex) пакета, што подразумева коришћење засебне bib датотеке у којој се дефинише литература.
* Постављено је одговарајуће форматирање листинга где се примењују боје, прикладан фонт и приказују се бројеви редова. Такође се врши распарчавање дугачких редова у листингу на више редова са одговарајућим форматирањем.

## Коришћење

### Опције класе

Опције задате класи се обрађују у редоследу у којем су задате. Дефинисане су следеће опције, а подебљане су подразумеване, уколико нису експлицитно задате њима супротне опције:

* bachelor &mdash; документ је завршни рад
* **diploma** &mdash; документ је дипломски рад
* master &mdash; документ је мастер рад
* hints &mdash; уколико није задата нека од потребних информација за насловне стране и страну са апстрактом, на одговарајућем месту се појављује помоћни текст који указује на тачну наребду коју треба користити
* **nohints** &mdash; искључује приказ помоћног текста на насловним странама и страном са апстрактом уколико нека од обавезних наредби није коришћена
* **usehyperref** &mdash; користи се [hyperref](https://ctan.org/pkg/hyperref) пакет
* nousehyperref &mdash; искључује коришћење [hyperref](https://ctan.org/pkg/hyperref) пакета
* **pdfmetadata** &mdash; уколико је задата опција usehyperref, попуњавају се одговарајућа поља мета-података излазне pdf датотеке
* nopdfmetadata &mdash; искључује попуњавање поља мета-података излазне pdf датотеке
* pdfcoursesubject &mdash; уколико су задате опције usehyperref и pdfmetadata, садржај поља мета-податка излазне pdf датотеке под називом "Subject" попуњава се називом предмета
* **nopdfcoursesubject** &mdash; искључује попуњавање поља мета-податка "Subject" у излазној pdf датотеци

Подразумеване опције класе су следеће: **diploma**, **nohints**, **usehyperref**, **pdfmetadata**, **nopdfcoursesubject**

### Наредбе за насловне стране

Следећим наредбама се управља садржајем насловних страна:

* `\title{...}` &mdash; наслов завршног, дипломског или мастер рада
* `\author{...}` &mdash; име, средње слово и презиме аутора (студента)
* `\date{YYYY-MM-DD}` &mdash; датум
* `\studid{...}` &mdash; број индекса
* `\studprog{...}` &mdash; назив студијског програма
* `\module{...}` &mdash; назив модула; ова наредба није обавезна за коришћење
* `\course{...}` &mdash; назив предмета
* `\advisor{...}` &mdash; име ментора са титулом
* `\advisorfull{...}` &mdash; име ментора са титулом и наставним звањем
* `\committee{...}` &mdash; овом наредбом додаје се један члан комисије; може се користити више пута за додавање више чланова комисије
* `\addbibresource{main.bib}` &mdash; увози се датотека `main.bib` као извор информација за литературу
* `\titlepagebib{key}` &mdash; овом наредбом додаје се један ред литературе *на насловној страни*, где је `key` кључ ставке у увезеној .bib датотеци; може се користити више пута за додавање додатне литературе
* `\studentshould{...}` &mdash; управља се садржајем насловне стране која почиње са "*У оквиру овог завршног/дипломског/мастер рада кадидат треба да...*"
* `\thesisapplicationfile{path}` &mdash; приказује скенирану пријаву завршног/дипломског/мастер рада на четвртој насловној страни, где је `path` релативна путања ка слици или pdf датотеци која садржи скенирану пријаву

За генерисање насловних страна у документу користи се наредба `\maketitle`.

### Наредбе за апстракт/резиме

Следећим наредбама дефинише се садржај апстракта:

* `\abstracten{...}` &mdash; апстракт на енглеском
* `\keywordsen{...}` &mdash; кључне речи на енглеском
* `\abstractsr{...}` &mdash; апстракт на српском
* `\keywordssr{...}` &mdash; кључне речи на српском

За генерисање стране са апстрактом у документу користи се наредба `\makeabstract`.

### Остале наредбе

Остале наредбе које дефинише класа `finthesis`, а могу бити корисне су:

* `\thesiscase{case}` &mdash; исписује тип рада (завршни, дипломски, мастер), где је `case` одговарајући суфикс добијен применом падежа. На пример, текст "У оквиру овог `\thesiscase{ог}` рада\ldots" претвара се у:

  * "У оквиру овог дипломског рада…" &mdash; уколико је задата опција *diploma* класи
  * "У оквиру овог завршног рада…" &mdash; уколико је задата опција *bachelor* класи
  * "У оквиру овог мастер рада…" &mdash; уколико је задата опција *master* класи

* `\setlstmaxlinedigits{num}` &mdash; информише класу о максималној дужини (по броју цифара) нумерације редова у листинзима, ради извођења правилног поравнања у односу на леву маргину документа; подразумевана вредност параметра `num` је 2, односно подразумева се да се листинзи састоје највише из двоцифреног броја редова.

### Измена форматирања листинга

Пошто су у класи посебно дефинисане боје које се примењују за разне елементе листинга, могуће је изменити дефиниције тих боја, што ће се одразити и на листинге. Следе дефиниције боја за листинге у класи:

```latex
\definecolor{finNumber}{HTML}{949698}               % Нумерација редова
\definecolor{finRule}{HTML}{949698}                 % Вертикална линија
\definecolor{finKeyword}{HTML}{228B22}              % Кључне речи
\definecolor{finComment}{rgb}{0.127,0.427,0.514}    % Коментари
\definecolor{finString}{rgb}{0.639,0.082,0.082}     % Ниске
\definecolor{finIdentifier}{HTML}{221E1F}           % Идентификатори
```

За већу контролу над форматирањем листинга потребно је користити `\lstset{...}` наредбу. Пример примене ове наредбе за извођење тренутног форматирања листинга може се наћи унутар изворног кода саме класе.

## Пример коришћења

Пример коришћења ове класе за израду дипломског рада доступан је и као следећи [Overleaf пројекат](https://www.overleaf.com/read/nbqytjnmxhjw).

## Могући проблеми који се могу јавити приликом коришћења класе

### Не свиђа ми се како је LaTeX преломио наслов мог рада

LaTeX има своје алгоритме за рачунање како је најбоље изломити дугачак ред текста на више редова, који у случају наслова не даје увек идеално естетско решење.

**Решење:** Коришћењем наредбе `\\` може се форсирати прављење новог реда на месту где се та наредба користи.

*Пример:*

```latex
\title{Израда примера дипломског рада у \LaTeX\ пакету коришћењем\\класе \emph{finthesis}}
%                                                                 ^--- овде се прелама ред
```

### Пакет hyperref избацује упозорење типа: "Package hyperref Warning: Token not allowed in a PDF string (Unicode): removing `XXX' on input line YYY."

Овај проблем се јавља када се користи нека наредба унутар текста који се уписује у мета-податке излазне pdf датотеке. Нарочито ако се користи математички фонт у наслову рада или насловима одељака. У том случају такви специјални карактери ће бити изостављени из садржаја и мета-података излазне pdf датотеке.

**Решење:** Користити наредбу `\texorpdfstring{texstring}{normalstring}`, где је `texstring` секвенца која изазива овај проблем, а `normalstring` "нормална" верзија те секвенце без проблематичних наредби или специјалних карактера као што су математички симболи.

*Пример:* `\section{\texorpdfstring{$k$}{k}-димензионални простор}`

Уколико пакет hyperref прави доста проблема унутар документа, његово коришћење се може искључити прослеђивањем опције nousehyperref класи.

### Ставке литературе&mdash;или генерално реченице&mdash;на страном језику пробијају десну маргину документа

Може се десити да LaTeX не може разломити неки текст на више редова без прављења превеликих размака између појединачних речи у неким редовима. Ово важи за случајеве када се разламање редова врши искључиво на местима између речи. У таквим случајевима LaTeX покушава да разламање врши такође и у оквиру појединачних речи, на граматички исправан начин. Уколико разламање редова на местима унутар појединачних речи није могуће, LaTeX онда више преферира да понеке речи пробијају маргину документа него да се прави превелики размак између речи.

Пошто је класа `finthesis` подешена тако да подразумева граматику српског језика, LaTeX онда не зна како да разломи речи написане на страном језику. Из тог разлога је искључена функционалност разламања редова текста написаних на страном језику унутар појединачних речи, што доводи до пробијања десне маргине документа у таквим случајевима.

**Решење:** За одређени блок текста могуће је подесити граматичка правила тако да она одговарају страном језику. У ту сврху користи се наредба `\foreignlanguage{language}{text}`, коју пружа пакет [babel](https://ctan.org/pkg/babel). Ова наредба се такође може користити унутар .bib датотеке.

*Пример: (унутар .bib датотеке)*

```bibtex
@inproceedings{thepaper,
    ...
    booktitle = {\foreignlanguage{english}{PROCEEDINGS IX International Conference IcETRAN and LXVI ETRAN Conference, Novi Pazar, Serbia, 6--9. June, 2022.}},
    ...
}
```

### LaTeX ротира моје слике када их убацим у рад

Овај проблем је нарочито значајан уколико се јавља код слике која садржи скенирану пријаву рада, пошто у том случају корисник класе нема начина да је ротира назад путем LaTeX наредби. Проблем се јавља код датотека слика са екстензијом .jpg, када су пиксели у датотеци упаковани редоследом који не одговара правој оријентацији слике. У том случају, такве .jpg датотеке у себи садрже мета-податак о правој оријентацији слике, тако да сваки читач слика зна да прво треба да је ротира на одређени начин пре приказивања кориснику. Нажалост, LaTeX наредба `\includegraphics[...]{...}` игнорише овај мета-податак и пикселе слике приказује онако како су у датотеци упаковани. Више информација може се наћи [овде](https://tex.stackexchange.com/questions/640647/why-did-latex-rotate-my-picture).

**Решење:** Потребно је изменити .jpg датотеку тако да оријентација слике одговара редоследу паковања пиксела унутар датотеке. Једно решење може бити отварање слике у софтверу за измену слика и њено поновно чување као нове .jpg датотеке (коришћењем опције *Save As...*). Алтернативно решење би било извожење .jpg датотеке у другом формату, нпр. као .png датотеку или као .pdf датотеку.

### Желим да из рада избацим насловну страну која садржи скенирани пимерак пријаве рада

Из разних околности може доћи до потребе да се из рада избаци насловна страна која би требало да садржи скенирани примерак пријаве самог рада. За овакве случајеве најбоље је прво проверити са студентском службом да ли може да се та страна уклони из рада, а уколико се од службе за то добије одобрење онда се може наставити са решењем.

**Решење:** Свака од насловних страна ове класе има дефинисану сопствену наредбу за њено генерисање. У преамбули документа потребно је изменити дефиницију наредбе `\maketitle` тако да се изоставља наредба која генерише четврту насловну страну (она садржи пријаву рада):

```latex
% Изгубили смо пријаву мастер рада, али студентска служба каже да није неопходна.
\renewcommand{\maketitle}{%
    \firsttitlepage%
    \secondtitlepage%
    \thirdtitlepage%
%   \fourthtitlepage%
}
```

### Редни бројеви редова у листинзима пробијају леву маргину документа

Форматирање листинга је подешено тако да се подразумева да ће сваки листинг имати највише 99 редова, односно нумерација редова у листинзима ће у највећу руку бити двоцифрена. Уколико неки листинг има троцифрени број редова, прве цифре редова са троцифреном нумерацијом ће пробијати леву маргину документа.

**Решење:** Користити наредбу `\setlstmaxlinedigits{num}`, где је `num` максимални број цифара који могу да имају редни бројеви редова у листингу.

*Пример:* `\setlstmaxlinedigits{3} % Ставити ову наредбу негде у преамбули документа уколико постоје листинзи са троцифреним бројем редова.`
